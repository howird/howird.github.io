# K-Means Clustering

```py
def kmeans(X, k=3, max_iterations=3):
    N, dim = X.shape
    means = X[np.random.choice(N, size=(k,), replace=False)]

    for i in range(max_iterations):
        dists = euclidean(X, means)
        labels = np.argmin(dists, axis=1)
        j = np.sum(dists)

        if len(ret) > 0 and (ret[-1][0] == labels).all():
            print(f"Early stop at index {i}")
            break
        
        for j in range(k):
            means[j] = X[np.where(np.argmin(dists, axis=1)==j)].mean(axis=0)
```

- First we take k random samples from our points and use them as our initial values for the k means

- 

```py
N, dim = clusters.shape
means = clusters[np.random.choice(N, size=(k,), replace=False)]
```

-

```py
def euclidean(clusters, means):
    return np.vstack([np.linalg.norm(clusters - a, axis=1) for a in means]).T
```

- Hi

```py
dists
```


$$
\begin{bmatrix}
    x_{11}       & x_{12} & x_{13} & \dots  & x_{1n} \\
    x_{21}       & x_{22} & x_{23} & \dots  & x_{2n} \\
    \vdots       & \vdots & \vdots & \ddots & \vdots \\
    x_{d1}       & x_{d2} & x_{d3} & \dots  & x_{dn}
\end{bmatrix}
$$